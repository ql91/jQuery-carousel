/* 2016-01-13
 * by Qin
 */
(function($){$.fn.carouselBox=function(options){var infoArr=options.infoArr,inOut=options.inOut,prevNext=options.prevNext,duration=(options.duration=="default"?2500:options.duration),caroselBoxWidth=$(".caroselBox").width(),caroselBoxHeight=$(".caroselBox").height(),curIndex=0,imgLen=$(".img").length;if(caroselBoxHeight<180){infoArr=[]}$(".caroselBox").css({"height":caroselBoxHeight,"width":caroselBoxWidth});$(".imgList").css({"width":caroselBoxWidth,"height":caroselBoxHeight});$(".imgList img").css({"width":caroselBoxWidth,"height":caroselBoxHeight});var addCtrlHtml='<div class="addCtrl">'+'<div class="prev"></div>'+'<div class="next"></div></div>';var footerHtml='<div class="footer"></div>';$(".caroselBox").append(addCtrlHtml,footerHtml);if(prevNext==false){$(".addCtrl").hide()}var infoListSize=imgLen,footerInfoLi='<ul class="infoList">',footerIndexLi='<ul class="indexList">';for(var i=0;i<imgLen;i++){if(i==0){footerInfoLi+='<li class="infoOn">'+(infoArr[i]==null?"":infoArr[i])+"</li>";footerIndexLi+='<li class="indexOn"></li>'}else{footerInfoLi+="<li>"+(infoArr[i]==null?"":infoArr[i])+"</li>";footerIndexLi+="<li></li>"}}footerIndexLi+="</ul>";footerIndexLi+="</ul>";$(".infoList").append(footerInfoLi);$(".indexList").append(footerIndexLi);$(".footer").append(footerInfoLi,footerIndexLi);$(".prev").css({"top":caroselBoxHeight/2.5});$(".next").css({"top":caroselBoxHeight/2.5});$(".arrowBtn").css({"top":caroselBoxHeight/400,"position":"absolute"});var footerH=caroselBoxHeight*0.2>50?"50":caroselBoxHeight*0.2;$(".footer").css({"height":footerH});$(".infoList").css({"height":footerH-20});$(".indexList").css({"height":footerH});$(".indexList li").css({"width":caroselBoxHeight*0.02,"height":caroselBoxHeight*0.02});$(".indexList li:first-child").css({"marginLeft":caroselBoxWidth*2/8});var autoChange=setInterval(function(){if(curIndex<imgLen-1){curIndex++}else{curIndex=0}changeTo(curIndex)},2500);$(".prev").hover(function(){clearInterval(autoChange)},function(){autoChangeAgain()});$(".prev").click(function(){curIndex=(curIndex>0)?(--curIndex):(imgLen-1);changeTo(curIndex)});$(".next").hover(function(){clearInterval(autoChange)},function(){autoChangeAgain()});$(".next").click(function(){curIndex=(curIndex<imgLen-1)?(++curIndex):0;changeTo(curIndex)});$(".indexList").find("li").each(function(item){$(this).hover(function(){clearInterval(autoChange);changeTo(item);curIndex=item},function(){autoChangeAgain()})});function autoChangeAgain(){autoChange=setInterval(function(){if(curIndex<imgLen-1){curIndex++}else{curIndex=0}changeTo(curIndex)},2500)}function changeTo(num){if(inOut=="fade"){$(".imgList .img").filter(":visible").fadeOut(500).parent().children().eq(num).fadeIn(1000)}else{if(inOut=="switch"){$(".imgList").css({"width":caroselBoxWidth*imgLen});var goLeft=num*caroselBoxWidth;$(".imgList").animate({left:"-"+goLeft+"px"},500)}}$(".infoList").find("li").removeClass("infoOn").eq(num).addClass("infoOn");$(".indexList").find("li").removeClass("indexOn").eq(num).addClass("indexOn")}}})(jQuery);